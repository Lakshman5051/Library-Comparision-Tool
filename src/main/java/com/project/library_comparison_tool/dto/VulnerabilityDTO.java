package com.project.library_comparison_tool.dto;

import com.project.library_comparison_tool.entity.Vulnerability;
import lombok.*;

import java.time.LocalDate;

@Getter
@Setter
@NoArgsConstructor
@AllArgsConstructor
@Builder
public class VulnerabilityDTO {
    private Long id;
    private String vulnerabilityId; // CVE ID, GHSA ID, or OSV ID
    private String summary;
    private String details;
    private String severity; // "CRITICAL", "HIGH", "MEDIUM", "LOW"
    private String cvssScore;
    private String affectedVersionRange;
    private String fixedVersion;
    private LocalDate publishedDate;
    private LocalDate modifiedDate;
    private String source; // "OSV", "GitHub", "NVD"
    private String references;

    public static VulnerabilityDTO fromEntity(Vulnerability vulnerability) {
        if (vulnerability == null) {
            return null;
        }

        return VulnerabilityDTO.builder()
                .id(vulnerability.getId())
                .vulnerabilityId(vulnerability.getVulnerabilityId())
                .summary(vulnerability.getSummary())
                .details(vulnerability.getDetails())
                .severity(vulnerability.getSeverity())
                .cvssScore(vulnerability.getCvssScore())
                .affectedVersionRange(vulnerability.getAffectedVersionRange())
                .fixedVersion(vulnerability.getFixedVersion())
                .publishedDate(vulnerability.getPublishedDate())
                .modifiedDate(vulnerability.getModifiedDate())
                .source(vulnerability.getSource())
                .references(vulnerability.getReferences())
                .build();
    }
}

